<html>
	<head>
		<title>Telepresence Control Panel</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		<script src="js/eventemitter2.js" type="text/javascript"></script>
		<script src="js/ros.min.js" type="text/javascript"></script>
		<script src="js/joystick.js" type="text/javascript"></script>
		<script src="js/main.js" type="text/javascript"></script>
		<script type="text/javascript">
		$("document").ready(function() {
			//connect as soon as the document is done loading
			initialize();

			setParamService();
			setUserViewService();
			
			setCmdVelTopic("/usc_mrp/control_command");
			setImageTopic("user", null, $("#main_feed img"));
			setImageTopic("original", null, $("#feed_2 img"));
			setImageTopic("crop1", null, $("#feed_3 img"));
			setImageTopic("crop2", null, $("#feed_4 img"));
			setImageTopic("quality1", null, $("#feed_5 img"));

			setUpDirectionButtons($("#direction_buttons div"))
			setUpJoysticks($("#joystick"));

			$("#allow_user_input_checkbox").change(function() {
				var isChecked = $(this).is(':checked');
				paramService.callService(new ros.ServiceRequest({
					topicName : 'allow_user_input', 
					value : isChecked
				}), function() { });
			});

			$("#allow_control_input_checkbox").change(function() {
				var isChecked = $(this).is(':checked');
				paramService.callService(new ros.ServiceRequest({
					topicName : 'allow_control_input', 
					value : isChecked
				}), function() { });
			})
		});
		</script>
		<link rel="stylesheet" href="style.css" />
	</head>
	<body>
		<div id="control_bar">Control Panel</div>
		<div id="main">
			<div id="feeds">
				<div id="main_feed" class="feed"><img src="images/dummy.jpg" /><div>User View</div></div>
				<div id="feed_2" class="feed"><img src="images/dummy.jpg" /><div>Original</div></div>
				<div id="feed_3" class="feed"><img src="images/dummy.jpg" /><div>Crop 1</div></div>
				<div id="feed_4" class="feed"><img src="images/dummy.jpg" /><div>Crop 2</div></div>
				<div id="feed_5" class="feed"><img src="images/dummy.jpg" /><div>Bad Quality 1</div></div>
				<div id="feed_6" class="feed"><img src="images/dummy.jpg" /></div>
				<div id="feed_7" class="feed"><img src="images/dummy.jpg" /></div>
				<div class="clear"></div>
			</div>
		</div>

		<div id="sidebar">
			<div id="instructions">
				<h1>Control Panel</h1>
				<p>Experiment staff only.</p>
				<p id="error" class="error"></p>
			</div>
			<div class="controls" id="direction_buttons">
				<div id="ccw">&lt; ccw</div>
				<div id="up">up</div>
				<div id="cw">cw &gt;</div>
				<div id="left">left</div>
				<div id="down">down</div>
				<div id="right">right</div>
				<span class="clear"></span>
			</div>

			<div class="controls" id="joystick">
				<div id="left_joystick">
					<div class="stick"></div>
				</div>

				<div id="right_joystick">
					<div class="stick"></div>
				</div>
				<span class="clear"></span>
			</div>

			<div class="controls" id="options">
				<div class="allow_inputs">
					<label for="allow_user_input_checkbox"><input type="checkbox" id="allow_user_input_checkbox" />Allow user input</label><br />
					<label for="allow_control_input_checkbox"><input type="checkbox" id="allow_control_input_checkbox" />Allow control panel input</label>
				</div>
				<button id="reset_robot">Reset</button>
				<button id="estop">Emergency Stop</button>
			</div>
		</div>
	</body>
</html>